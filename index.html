<html>
<head>
  <META http-equiv="Content-Type" content="text/html; charset=utf-8">
  <META http-equiv="Content-Style-Type" content="text/css">
  <title>Map test</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js" type="text/javascript"></script>
  <style type="text/css">
     canvas { border: 1px solid black; }
   </style>
</head>
<body>
    <h1>blah</h1>
    <div>
        <canvas id="mapCanvas" width="800" height="495">
        </canvas>
    </div>
  <script type="application/x-javascript">
    var ctx;
    var mapImage;
    // The general-purpose event handler. This function just determines the mouse 
    // position relative to the canvas element.
    function ev_canvas (ev) {
        if (ev.layerX || ev.layerX == 0) { // Firefox
            ev._x = ev.layerX;
            ev._y = ev.layerY;
        } else if (ev.offsetX || ev.offsetX == 0) { // Opera
            ev._x = ev.offsetX;
            ev._y = ev.offsetY;
        }
        alert('hit at ' + ev._x + ', ' + ev._y);
    }
    function imageLoaded() {
        ctx.drawImage(mapImage, 0, 0);
    }
    $(document).ready(function() {
        var canvas = document.getElementById('mapCanvas');
        ctx = canvas.getContext('2d');
        mapImage = new Image();
        $(mapImage).load(imageLoaded);
        mapImage.src = 'svg/largemap.png';
        // TODO - click handler?
        canvas.addEventListener('mouseup', ev_canvas, false);

    });
   </script>
 
</body>
</html>
